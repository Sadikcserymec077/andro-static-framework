<!doctype html>
<html>
<head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>Search Scans</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<nav class="navbar navbar-light bg-light"><div class="container"><a class="navbar-brand" href="/">Static Analysis</a></div></nav>
<main class="container my-4">
  <h4>Search scans</h4>
  <form method="post" class="d-flex gap-2 mb-3">
    <input class="form-control" name="query" placeholder="filename or package" value="{{ query }}">
    <button class="btn btn-primary">Search</button>
  </form>
  <div class="card p-3">
    <table class="table">
      <thead><tr><th>Scan ID</th><th>File</th><th>Package</th><th>Total</th><th>Date</th><th></th></tr></thead>
      <tbody>
        {% for r in results %}
          <tr>
            <td style="max-width:240px; word-break:break-all">{{ r['scan_id'] }}</td>
            <td>{{ r['filename'] }}</td>
            <td>{{ r['package_name'] }}</td>
            <td>{{ r['total'] }}</td>
            <td>{{ r['created_at'] }}</td>
            <td><a class="btn btn-sm btn-primary" href="{{ url_for('results', scan_id=r['scan_id']) }}">View</a></td>
          </tr>
        {% else %}
          <tr><td colspan="6" class="text-muted">No results</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</main>
</body>
</html>
